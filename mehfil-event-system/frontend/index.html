<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mehfil - Cultural Event Management Platform</title>
    <meta name="description" content="Discover and attend amazing cultural events in your area. Connect with artists, organizers, and fellow culture enthusiasts.">
    <meta name="keywords" content="cultural events, poetry, music, theater, dance, community, booking">
    <meta name="author" content="Mehfil Team">
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#9333ea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Mehfil">
    <link rel="apple-touch-icon" href="assets/images/icon-192x192.png">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Mehfil - Cultural Event Management Platform">
    <meta property="og:description" content="Discover and attend amazing cultural events in your area">
    <meta property="og:image" content="assets/images/og-image.jpg">
    <meta property="og:url" content="https://mehfil.app">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Mehfil - Cultural Event Management Platform">
    <meta name="twitter:description" content="Discover and attend amazing cultural events in your area">
    <meta name="twitter:image" content="assets/images/twitter-card.jpg">
    
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="index.html" class="brand-link">
                    <i class="fas fa-masks"></i>
                    <span class="brand-text">Mehfil</span>
                </a>
            </div>
            
            <div class="nav-menu" id="navMenu">
                <a href="index.html" class="nav-link active">Home</a>
                <a href="events.html" class="nav-link">Events</a>
                <a href="pages/about.html" class="nav-link">About</a>
                <a href="pages/contact.html" class="nav-link">Contact</a>
            </div>
            
            <div class="nav-auth" id="navAuth">
                <a href="auth.html" class="btn btn-outline">Login</a>
                <a href="auth.html?register=true" class="btn btn-primary">Sign Up</a>
            </div>
            
            <div class="nav-user hidden" id="navUser">
                <div class="user-dropdown">
                    <button class="user-btn" id="userBtn">
                        <img src="assets/images/default-avatar.svg" alt="Profile" class="user-avatar" id="userAvatar">
                        <span class="user-name" id="userName">User</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <a href="dashboard.html" class="dropdown-item">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a>
                        <a href="profile.html" class="dropdown-item">
                            <i class="fas fa-user"></i> Profile
                        </a>
                        <a href="pages/notifications.html" class="dropdown-item">
                            <i class="fas fa-bell"></i> Notifications
                            <span class="notification-badge" style="display: none;">0</span>
                        </a>
                        <a href="pages/event-management.html" class="dropdown-item organizer-only admin-only">
                            <i class="fas fa-calendar-check"></i> Event Management
                        </a>
                        <a href="pages/analytics.html" class="dropdown-item organizer-only admin-only">
                            <i class="fas fa-chart-bar"></i> Analytics
                        </a>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item logout-btn" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="nav-toggle" id="navToggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-background">
            <div class="hero-overlay"></div>
        </div>
        <div class="hero-content">
            <div class="container">
                <div class="hero-text">
                    <h1 class="hero-title">
                        Experience the Magic of
                        <span class="gradient-text">Cultural Events</span>
                    </h1>
                    <p class="hero-subtitle">
                        Discover, create, and participate in authentic cultural gatherings. 
                        Join our community of artists, poets, musicians, and culture enthusiasts.
                    </p>
                    <div class="hero-buttons">
                        <a href="events.html" class="btn btn-primary btn-large">
                            <i class="fas fa-calendar-alt"></i>
                            Explore Events
                        </a>
                        <a href="auth.html?register=true" class="btn btn-outline btn-large">
                            <i class="fas fa-user-plus"></i>
                            Join Community
                        </a>
                    </div>
                </div>
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-number" id="statsEvents">12</div>
                        <div class="stat-label">Events Hosted</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="statsAttendees">150+</div>
                        <div class="stat-label">Happy Attendees</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="statsArtists">25</div>
                        <div class="stat-label">Featured Artists</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Why Choose Mehfil?</h2>
                <p class="section-subtitle">Everything you need to create memorable cultural experiences</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <h3 class="feature-title">Easy Event Management</h3>
                    <p class="feature-description">Create and manage your cultural events with our intuitive tools. From poetry nights to music concerts.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <h3 class="feature-title">Smart Ticketing</h3>
                    <p class="feature-description">Seamless ticket booking with QR codes, multiple payment options, and instant confirmations.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 class="feature-title">Community Building</h3>
                    <p class="feature-description">Connect with fellow artists, organizers, and culture enthusiasts in your area.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <h3 class="feature-title">Artist Showcase</h3>
                    <p class="feature-description">Platform for artists to showcase their talent and build their audience.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h3 class="feature-title">Mobile Friendly</h3>
                    <p class="feature-description">Access your events and bookings anywhere with our responsive design.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 class="feature-title">Analytics & Insights</h3>
                    <p class="feature-description">Track your event performance with detailed analytics and insights.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Upcoming Events Section -->
    <section class="upcoming-events">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Upcoming Events</h2>
                <p class="section-subtitle">Don't miss these amazing cultural gatherings</p>
            </div>
            
            <div class="events-slider" id="eventsSlider">
                <!-- Events will be loaded here -->
                <div class="loading-skeleton">
                    <div class="skeleton-card"></div>
                    <div class="skeleton-card"></div>
                    <div class="skeleton-card"></div>
                </div>
            </div>
            
            <div class="section-footer">
                <a href="events.html" class="btn btn-primary">
                    View All Events
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="categories">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Event Categories</h2>
                <p class="section-subtitle">Explore different types of cultural events</p>
            </div>
            
            <div class="categories-grid">
                <a href="events.html?category=poetry" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-feather-alt"></i>
                    </div>
                    <h3 class="category-title">Poetry</h3>
                    <p class="category-description">Mushaira, Ghazal nights, and literary gatherings</p>
                </a>
                
                <a href="events.html?category=music" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-music"></i>
                    </div>
                    <h3 class="category-title">Music</h3>
                    <p class="category-description">Classical concerts, qawwali, and fusion performances</p>
                </a>
                
                <a href="events.html?category=dance" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-running"></i>
                    </div>
                    <h3 class="category-title">Dance</h3>
                    <p class="category-description">Classical dance, folk performances, and workshops</p>
                </a>
                
                <a href="events.html?category=theater" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-theater-masks"></i>
                    </div>
                    <h3 class="category-title">Theater</h3>
                    <p class="category-description">Drama productions, street plays, and comedy shows</p>
                </a>
                
                <a href="events.html?category=cultural" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-globe-asia"></i>
                    </div>
                    <h3 class="category-title">Cultural</h3>
                    <p class="category-description">Festivals, cultural exchanges, and heritage events</p>
                </a>
                
                <a href="events.html?category=literary" class="category-card">
                    <div class="category-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <h3 class="category-title">Literary</h3>
                    <p class="category-description">Book launches, author meetups, and discussions</p>
                </a>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta">
        <div class="container">
            <div class="cta-content">
                <h2 class="cta-title">Ready to Create Your Next Event?</h2>
                <p class="cta-subtitle">Join thousands of organizers who trust Mehfil for their cultural events</p>
                <div class="cta-buttons">
                    <a href="auth.html?register=true&role=organizer" class="btn btn-primary btn-large">
                        <i class="fas fa-plus-circle"></i>
                        Start Organizing
                    </a>
                    <a href="auth.html?register=true&role=artist" class="btn btn-outline btn-large">
                        <i class="fas fa-palette"></i>
                        Join as Artist
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-brand">
                        <a href="index.html" class="brand-link">
                            <i class="fas fa-masks"></i>
                            <span class="brand-text">Mehfil</span>
                        </a>
                        <p class="footer-description">
                            Connecting cultures through memorable events and authentic experiences.
                        </p>
                        <div class="social-links">
                            <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                            <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                            <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                        </div>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="events.html">Browse Events</a></li>
                        <li><a href="auth.html">Create Account</a></li>
                        <li><a href="pages/about.html">About Us</a></li>
                        <li><a href="pages/contact.html">Contact</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">For Organizers</h3>
                    <ul class="footer-links">
                        <li><a href="auth.html?register=true&role=organizer">Start Organizing</a></li>
                        <li><a href="create-event.html">Create Event</a></li>
                        <li><a href="pages/event-management.html">Manage Events</a></li>
                        <li><a href="pages/analytics.html">Analytics</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">For Artists</h3>
                    <ul class="footer-links">
                        <li><a href="auth.html?register=true&role=artist">Join as Artist</a></li>
                        <li><a href="profile.html">Artist Profile</a></li>
                        <li><a href="events.html">Find Opportunities</a></li>
                        <li><a href="pages/reviews.html">Reviews</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-copyright">
                    <p>&copy; 2025 Mehfil. All rights reserved.</p>
                </div>
                <div class="footer-legal">
                    <a href="#" onclick="showPrivacyModal()">Privacy Policy</a>
                    <a href="#" onclick="showTermsModal()">Terms of Service</a>
                    <a href="#" onclick="showCookiesModal()">Cookie Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/config.js"></script>
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/api.js"></script>
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/main.js"></script>
    
    <script>
        // Homepage specific event loading with enhanced debugging
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🏠 Homepage DOMContentLoaded - Loading events...');
            
            // Load events for homepage preview
            try {
                console.log('📡 Fetching events from API...');
                const response = await fetch('http://localhost:5000/api/events');
                console.log('📡 Response status:', response.status, response.statusText);
                
                if (response.ok) {
                    const events = await response.json();
                    console.log('✅ Events loaded successfully:', events.length);
                    console.log('📊 Sample event data:', events[0]);
                    
                    // Update homepage stats
                    const statsEvents = document.getElementById('statsEvents');
                    if (statsEvents) {
                        statsEvents.textContent = events.length;
                        console.log('📈 Updated stats counter');
                    } else {
                        console.warn('⚠️ Stats element not found');
                    }
                    
                    // Load events in slider
                    const eventsSlider = document.getElementById('eventsSlider');
                    console.log('🎠 Events slider element:', eventsSlider);
                    
                    if (eventsSlider && events.length > 0) {
                        console.log('🎨 Generating event cards...');
                        const eventsHTML = events.slice(0, 3).map(event => {
                            const imageUrl = event.images && event.images[0] ? event.images[0] : 'assets/images/default-event.svg';
                            const price = event.ticketing && event.ticketing.ticketTypes && event.ticketing.ticketTypes[0] 
                                ? '$' + event.ticketing.ticketTypes[0].price 
                                : 'Free';
                            
                            console.log(`🎫 Event: ${event.title}, Price: ${price}`);
                            
                            return `
                                <div class="event-card">
                                    <div class="event-image">
                                        <img src="${imageUrl}" alt="${event.title}" onerror="console.log('Image failed to load:', this.src)">
                                    </div>
                                    <div class="event-content">
                                        <h3 class="event-title">${event.title}</h3>
                                        <p class="event-date">
                                            <i class="fas fa-calendar"></i>
                                            ${new Date(event.dateTime.start).toLocaleDateString()}
                                        </p>
                                        <p class="event-location">
                                            <i class="fas fa-map-marker-alt"></i>
                                            ${event.venue.name}
                                        </p>
                                        <p class="event-price">
                                            ${price}
                                        </p>
                                        <a href="event-details.html?id=${event._id}" class="btn btn-primary">View Details</a>
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        eventsSlider.innerHTML = eventsHTML;
                        console.log('✅ Events displayed in slider successfully');
                    } else {
                        console.warn('⚠️ Events slider not found or no events available');
                        console.log('Element found:', !!eventsSlider, 'Events count:', events.length);
                    }
                } else {
                    console.error('❌ Failed to load events:', response.status, response.statusText);
                }
            } catch (error) {
                console.error('💥 Error loading events:', error);
                console.error('Stack trace:', error.stack);
                
                // Show error in slider if possible
                const eventsSlider = document.getElementById('eventsSlider');
                if (eventsSlider) {
                    eventsSlider.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #e74c3c;">
                            <h3>Unable to load events</h3>
                            <p>Please check your connection and try refreshing the page.</p>
                        </div>
                    `;
                }
            }
        });
    </script>
</body>
</html>
